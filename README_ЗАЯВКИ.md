# Функциональность просмотра заявок

## Описание

В проекте реализована полная функциональность для просмотра и управления заявками, поступающими из форм на сайте:

1. **Заявки калькулятора** - заявки, созданные через калькулятор строительства
2. **Обратная связь** - сообщения, отправленные через форму контактов

## Структура данных

### Модель Request (Заявки калькулятора)
- `house_type_id` - тип дома
- `area` - площадь
- `floor_id` - этажность
- `roof_id` - тип крыши
- `material_id` - материал стен
- `foundation_id` - тип фундамента
- `facade_id` - технология фасада
- `electrical_id` - вариант электрики
- `wall_finish_id` - отделка стен
- `additions` - дополнительные опции (JSON)
- `name` - имя заказчика
- `phone` - телефон
- `email` - email
- `comment` - комментарий
- `total_price` - итоговая стоимость
- `status` - статус заявки (new, in_progress, completed, cancelled)

### Модель Feedback (Обратная связь)
- `firstname` - имя
- `tel` - телефон
- `email` - email
- `subject` - сообщение

## Админ-панель

### Доступ к админ-панели
1. Перейдите по адресу: `http://localhost:8000/admin`
2. Введите пароль: `Respons1`

### Разделы админ-панели

#### 1. Панель управления
- Статистика по заявкам и обращениям
- Последние заявки
- Последние обращения

#### 2. Заявки калькулятора
- Просмотр всех заявок
- Детальная информация о заявке
- Изменение статуса заявки
- Удаление заявки

#### 3. Обратная связь
- Просмотр всех обращений
- Детальная информация об обращении
- Удаление обращения

### Функции админ-панели

#### Просмотр заявок
- Таблица со всеми заявками
- Сортировка по дате создания (новые вверху)
- Отображение статуса с цветовой индикацией
- Форматирование стоимости в рублях

#### Детальная информация о заявке
- Контактные данные заказчика
- Все параметры выбранного дома
- Список дополнительных опций
- Итоговая стоимость
- Возможность изменения статуса

#### Управление статусами
- **Новая** - заявка только что поступила
- **В работе** - заявка обрабатывается
- **Завершена** - работа по заявке завершена
- **Отменена** - заявка отменена

## API Endpoints

### Получение данных
- `GET /admin/api/requests/stats` - статистика заявок
- `GET /admin/api/data/requests` - все заявки
- `GET /admin/api/data/feedback` - все обращения

### Управление заявками
- `PUT /admin/api/requests/{id}/status` - обновление статуса заявки
- `DELETE /admin/api/data/requests/{id}` - удаление заявки
- `DELETE /admin/api/data/feedback/{id}` - удаление обращения

## Тестирование

### Создание тестовых данных
```bash
php artisan test:create-data
```

### Запуск сервера разработки
```bash
php artisan serve
```

### Проверка функциональности
1. Откройте админ-панель: `http://localhost:8000/admin`
2. Войдите с паролем: `Respons1`
3. Проверьте разделы "Заявки калькулятора" и "Обратная связь"
4. Попробуйте изменить статус заявки
5. Просмотрите детальную информацию о заявке

## Особенности реализации

### Безопасность
- Аутентификация через сессии
- Проверка прав доступа для всех API endpoints
- Валидация данных на сервере

### Пользовательский интерфейс
- Адаптивный дизайн
- Цветовая индикация статусов
- Модальные окна для детальной информации
- Уведомления об успешных операциях

### Производительность
- Загрузка данных через AJAX
- Пагинация для больших объемов данных
- Кэширование статистики

## Структура файлов

```
app/
├── Http/Controllers/
│   ├── AdminController.php          # Контроллер админ-панели
│   ├── CalculatorRequestController.php  # Обработка заявок калькулятора
│   └── FeedbackController.php       # Обработка обратной связи
├── Models/
│   ├── Request.php                  # Модель заявок
│   └── Feedback.php                 # Модель обращений
└── Console/Commands/
    └── CreateTestData.php           # Команда создания тестовых данных

resources/views/
└── admin.blade.php                  # Шаблон админ-панели

public/js/
└── admin.js                         # JavaScript админ-панели

routes/
└── web.php                          # Маршруты
```

## Возможные улучшения

1. **Фильтрация и поиск** - добавление фильтров по статусу, дате, имени
2. **Экспорт данных** - возможность экспорта заявок в Excel/PDF
3. **Уведомления** - email уведомления о новых заявках
4. **Комментарии** - возможность добавлять комментарии к заявкам
5. **История изменений** - отслеживание изменений статусов
6. **Массовые операции** - массовое изменение статусов
7. **Дашборд** - графики и аналитика по заявкам 